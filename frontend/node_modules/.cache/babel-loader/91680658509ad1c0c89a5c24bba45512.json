{"ast":null,"code":"import _objectSpread from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/src/components/scraperForm.jsx\";\nimport React, { Component } from \"react\";\nimport http from \"../services/httpService\";\nimport config from \"../config.json\";\nimport { toast } from \"react-toastify\";\nimport SkillsGrid from \"./skillsGrid\";\nimport InputList from \"./inputList.jsx\";\nimport Input from \"./input.jsx\";\n\nvar shortid = require(\"shortid\");\n\nvar Joi = require(\"joi\");\n\nvar ScraperForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ScraperForm, _Component);\n\n  function ScraperForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ScraperForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ScraperForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      jobTitle: \"\",\n      jobAliases: \"\",\n      skills: {},\n      aliases: {},\n      errors: {}\n    };\n\n    _this.escFunction = function (event) {\n      if (event.keyCode === 27) {\n        _this.setState({\n          errors: {}\n        });\n      }\n    };\n\n    _this.schema = {\n      // Job title cannot be blank\n      jobTitle: Joi.string().required().label(\"Job title\"),\n      jobAliases: Joi.any().label(\"Job aliases\"),\n      skills: Joi.object().pattern(/^/, Joi.string()).label(\"Skills\"),\n      aliases: Joi.object().pattern(/^/, Joi.any()).label(\"Aliases\"),\n      errors: Joi.object()\n    };\n    _this.fieldSchema = {\n      jobTitle: Joi.string().required().label(\"Job title\"),\n      jobAliases: Joi.any().label(\"Job aliases\"),\n      skills: Joi.string().required().label(\"Skill\"),\n      aliases: Joi.any(),\n      errors: Joi.object()\n    };\n\n    _this.validate = function () {\n      console.log(\"validating\");\n      var options = {\n        abortEarly: false\n      };\n\n      var _Joi$validate = Joi.validate(_this.state, _this.schema, options),\n          error = _Joi$validate.error,\n          value = _Joi$validate.value; // console.log(error.details);\n      // return(error);\n      // const { error } = Joi.validate( {jobTitle: this.state.jobTitle}, this.schema, options);\n\n\n      if (!error) return null;\n      var errors = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = error.details[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var item = _step.value;\n          errors[item.path[0]] = item.message;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      if (errors.hasOwnProperty(\"skills\")) {\n        errors[\"skills\"] = \"Skills cannot be blank\";\n      }\n\n      return errors;\n    };\n\n    _this.validateProperty = function (_ref) {\n      var name = _ref.name,\n          value = _ref.value;\n\n      var obj = _defineProperty({}, name, value);\n\n      var schema = _defineProperty({}, name, _this.fieldSchema[name]);\n\n      var _Joi$validate2 = Joi.validate(obj, schema),\n          error = _Joi$validate2.error;\n\n      return error ? error.details[0].message : null;\n    };\n\n    _this.handleSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var errors;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(\"handle post triggered\");\n                e.preventDefault();\n                errors = _this.validate();\n\n                _this.setState({\n                  errors: errors || {}\n                });\n\n                if (!errors) {\n                  _context.next = 6;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 6:\n                _context.prev = 6;\n                _context.next = 9;\n                return http.get(config.scraperServerAPIEndpoint, _this.state.jobTitle);\n\n              case 9:\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](6);\n                console.log(_context.t0);\n                toast.error(\"conection error\"); // this.setState({ job: originalJob });\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[6, 11]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.handleChange = function (e) {\n      var id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var _e$currentTarget = e.currentTarget,\n          name = _e$currentTarget.name,\n          value = _e$currentTarget.value;\n\n      var errors = _objectSpread({}, _this.state.errors);\n\n      var errorMessage = _this.validateProperty(e.currentTarget);\n\n      if (errorMessage) {\n        errors[name] = errorMessage;\n        console.log(\"errorMessage\", errorMessage, \"e.currentTarget\", e.currentTarget);\n      } else delete errors[name]; // console.log(\"current ids \", this.state.aliases);\n      // console.log(\"Updating name \", name, \" value \", value, \" id \", id);\n\n\n      if (id === null) {\n        var _this$setState;\n\n        // console.log(\"updating based on just name\")\n        _this.setState((_this$setState = {}, _defineProperty(_this$setState, name, value), _defineProperty(_this$setState, \"errors\", errors), _this$setState));\n      } else {\n        var _this$setState2;\n\n        // console.log(\"updating based on name and id\");\n        var temp = _this.state[name];\n        temp[id] = value;\n\n        _this.setState((_this$setState2 = {}, _defineProperty(_this$setState2, name, temp), _defineProperty(_this$setState2, \"errors\", errors), _this$setState2));\n      }\n    };\n\n    _this.handleCreateSkill = function () {\n      var id = shortid.generate();\n\n      var skills = _objectSpread({}, _this.state.skills);\n\n      var aliases = _objectSpread({}, _this.state.aliases);\n\n      skills[id] = \"\";\n      aliases[id] = \"\";\n\n      _this.setState({\n        skills: skills,\n        aliases: aliases\n      });\n    };\n\n    _this.handleDeleteSkill = function (id) {\n      console.log(\"deleting id \", id);\n\n      var skills = _objectSpread({}, _this.state.skills);\n\n      var aliases = _objectSpread({}, _this.state.aliases);\n\n      delete skills[id];\n      delete aliases[id];\n\n      _this.setState({\n        skills: skills,\n        aliases: aliases\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ScraperForm, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"keydown\", this.escFunction, false);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"keydown\", this.escFunction, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          errors = _this$state.errors,\n          jobTitle = _this$state.jobTitle,\n          jobAliases = _this$state.jobAliases,\n          skills = _this$state.skills,\n          aliases = _this$state.aliases;\n      var helperFunctions = {\n        handleChange: this.handleChange,\n        handleDeleteComponent: this.handleDeleteSkill\n      };\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \"Job title\"), React.createElement(Input, {\n        label: \"Job title\",\n        name: \"jobTitle\",\n        value: jobTitle,\n        onChange: function onChange(e) {\n          return _this2.handleChange(e);\n        },\n        margin: \"\",\n        size: \"form-control-lg\",\n        error: errors.jobTitle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), React.createElement(InputList, {\n        values: jobAliases,\n        name: \"jobAliases\",\n        id: null,\n        helperFunctions: helperFunctions,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, \"Skills\"), React.createElement(SkillsGrid, {\n        skills: skills,\n        aliases: aliases,\n        skillsName: \"skills\",\n        aliasesName: \"aliases\",\n        helperFunctions: helperFunctions,\n        numCols: 3,\n        error: errors.skills,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.handleCreateSkill,\n        className: \"btn-lg btn-success mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, \"Add skill\"), \" \"), React.createElement(\"button\", {\n        onClick: this.handleSubmit,\n        className: \"btn-lg btn-primary mt-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Submit\"));\n    }\n  }]);\n\n  return ScraperForm;\n}(Component);\n\nexport default ScraperForm;","map":{"version":3,"sources":["/Users/JGrundy/Documents/code/tech-skills-scraper-and-visualizer/frontend/react-app/src/components/scraperForm.jsx"],"names":["React","Component","http","config","toast","SkillsGrid","InputList","Input","shortid","require","Joi","ScraperForm","state","jobTitle","jobAliases","skills","aliases","errors","escFunction","event","keyCode","setState","schema","string","required","label","any","object","pattern","fieldSchema","validate","console","log","options","abortEarly","error","value","details","item","path","message","hasOwnProperty","validateProperty","name","obj","handleSubmit","e","preventDefault","get","scraperServerAPIEndpoint","handleChange","id","currentTarget","errorMessage","temp","handleCreateSkill","generate","handleDeleteSkill","document","addEventListener","removeEventListener","helperFunctions","handleDeleteComponent"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport http from \"../services/httpService\";\nimport config from \"../config.json\";\nimport { toast } from \"react-toastify\";\nimport SkillsGrid from \"./skillsGrid\";\nimport InputList from \"./inputList.jsx\";\nimport Input from \"./input.jsx\";\nconst shortid = require(\"shortid\");\nconst Joi = require(\"joi\");\n\nclass ScraperForm extends Component {\n  state = {\n    jobTitle: \"\",\n    jobAliases: \"\",\n    skills: {},\n    aliases: {},\n    errors: {}\n  };\n\n\n    // Validation\n  escFunction = (event) => {\n    if(event.keyCode === 27) {\n      this.setState({ errors: {} });\n    }\n  }\n  componentDidMount(){\n    document.addEventListener(\"keydown\", this.escFunction, false);\n  }\n  componentWillUnmount(){\n    document.removeEventListener(\"keydown\", this.escFunction, false);\n  }\n  \n  schema = {\n    // Job title cannot be blank\n    jobTitle: Joi.string()\n      .required()\n      .label(\"Job title\"),\n    jobAliases: Joi.any().label(\"Job aliases\"),\n    skills: Joi.object()\n      .pattern(/^/, Joi.string())\n      .label(\"Skills\"),\n    aliases: Joi.object()\n      .pattern(/^/, Joi.any())\n      .label(\"Aliases\"),\n    errors: Joi.object()\n  };\n\n  fieldSchema = {\n    jobTitle: Joi.string()\n      .required()\n      .label(\"Job title\"),\n    jobAliases: Joi.any().label(\"Job aliases\"),\n    skills: Joi.string().required().label(\"Skill\"),\n    aliases: Joi.any(),\n    errors: Joi.object()\n  };\n\n  validate = () => {\n    console.log(\"validating\");\n    const options = { abortEarly: false };\n    const { error, value } = Joi.validate(this.state, this.schema, options);\n    // console.log(error.details);\n    // return(error);\n\n    // const { error } = Joi.validate( {jobTitle: this.state.jobTitle}, this.schema, options);\n    if (!error) return null;\n    const errors = {};\n    for (let item of error.details) errors[item.path[0]] = item.message;\n    if (errors.hasOwnProperty(\"skills\")) {\n      errors[\"skills\"] = \"Skills cannot be blank\"\n    }\n    return errors;\n  };\n\n  validateProperty = ({ name, value }) => {\n    const obj = { [name]: value };\n    const schema = { [name]: this.fieldSchema[name] };\n    const { error } = Joi.validate(obj, schema);\n    return error ? error.details[0].message : null;\n  };\n\n\n\n  // Backend\n  handleSubmit = async e => {\n    console.log(\"handle post triggered\");\n    e.preventDefault();\n\n    const errors = this.validate();\n    this.setState({ errors: errors || {} });\n    if (errors) return;\n\n    // const originalJob = this.state.job;\n\n    try {\n      await http.get(\n        config.scraperServerAPIEndpoint,\n        this.state.jobTitle\n      );\n    } catch (ex) {\n      console.log(ex);\n      toast.error(\"conection error\");\n      // this.setState({ job: originalJob });\n    }\n  };\n\n\n  // Functionality\n  handleChange = (e, id = null) => {\n    const { name, value } = e.currentTarget;\n\n    const errors = { ...this.state.errors };\n    const errorMessage = this.validateProperty(e.currentTarget);\n    if (errorMessage) {\n      errors[name] = errorMessage;\n      console.log(\"errorMessage\", errorMessage, \"e.currentTarget\", e.currentTarget);\n    } else delete errors[name];\n\n    // console.log(\"current ids \", this.state.aliases);\n    // console.log(\"Updating name \", name, \" value \", value, \" id \", id);\n    if (id === null) {\n      // console.log(\"updating based on just name\")\n      this.setState({ [name]: value, errors: errors });\n    } else {\n      // console.log(\"updating based on name and id\");\n      let temp = this.state[name];\n      temp[id] = value;\n      this.setState({ [name]: temp, errors: errors });\n    }\n  };\n\n  handleCreateSkill = () => {\n    const id = shortid.generate();\n    let skills = { ...this.state.skills };\n    let aliases = { ...this.state.aliases };\n    skills[id] = \"\";\n    aliases[id] = \"\";\n    this.setState({ skills: skills, aliases: aliases });\n  };\n\n  handleDeleteSkill = id => {\n    console.log(\"deleting id \", id);\n    let skills = { ...this.state.skills };\n    let aliases = { ...this.state.aliases };\n    delete skills[id];\n    delete aliases[id];\n    this.setState({ skills: skills, aliases: aliases });\n  };\n\n  render() {\n    const { errors, jobTitle, jobAliases, skills, aliases } = this.state;\n    const helperFunctions = {\n      handleChange: this.handleChange,\n      handleDeleteComponent: this.handleDeleteSkill\n    };\n\n    return (\n      <div>\n        <h3 className=\"mt-5\">Job title</h3>\n        <Input\n          label=\"Job title\"\n          name=\"jobTitle\"\n          value={jobTitle}\n          onChange={e => this.handleChange(e)}\n          margin=\"\"\n          size={\"form-control-lg\"}\n          error={errors.jobTitle}\n        />\n        <InputList\n          values={jobAliases}\n          name=\"jobAliases\"\n          id={null}\n          helperFunctions={helperFunctions}\n        />\n\n        <div>\n          <h3 className=\"mt-5\">Skills</h3>\n          <SkillsGrid\n            skills={skills}\n            aliases={aliases}\n            skillsName=\"skills\"\n            aliasesName=\"aliases\"\n            helperFunctions={helperFunctions}\n            numCols={3}\n            error={errors.skills}\n          />\n          <button\n            onClick={this.handleCreateSkill}\n            className=\"btn-lg btn-success mt-5\"\n          >\n            Add skill\n          </button>{\" \"}\n        </div>\n        <button onClick={this.handleSubmit} className=\"btn-lg btn-primary mt-1\">\n          Submit\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default ScraperForm;\n"]},"metadata":{},"sourceType":"module"}